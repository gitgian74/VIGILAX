import{j as e,O as V,N as A,u as M,b as O,r as c,S as v,X as F,L as G,V as K,B as W,d as S,U as H,e as Q,f as X,M as Y,h as _,i as B,P as E,C as Z,D as J,T as U,k as ee,l as se,m as te,n as ae,o as re,W as ne,I as R,p as ie,q as le,s as ce,t as p,v as de,R as oe,Q as me,w as xe}from"./react-BUjUHKsi.js";import{an as he,ao as ue,ap as pe,aq as je,ar as fe,as as be,at as ye,au as Ne,av as ge}from"./vendor-DQIOco45.js";import{createRobotClient as ve,CameraClient as we}from"./viam-sdk-Cf9OlUZL.js";import{R as w,L as Ce,C as D,X as T,Y as L,T as C,a as ke,P as Ae,b as Se,c as Ee,B as Re,d as De}from"./charts-0XK_o7jm.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const b={endpoint:"https://fra.cloud.appwrite.io/v1",projectId:"6883392f00125f63c596",databaseId:"sg-security-db",collections:{users:"users",securityEvents:"security_events",securityZones:"security_zones",securityRules:"security_rules",notifications:"notifications",notificationPreferences:"notification_preferences",recordings:"recordings",systemLogs:"system_logs"},buckets:{eventVideos:"event-videos",eventSnapshots:"event-snapshots"},functions:{detectSecurityEvent:"detect-security-event",processVideoBuffer:"process-video-buffer",sendNotifications:"send-notifications",manageRecordings:"manage-recordings"},teams:{superAdmins:"super-admins",admins:"admins",users:"users"}};let k=null;function N(){return k||(k=new be().setEndpoint(b.endpoint).setProject(b.projectId)),k}const j=new he(N()),Te=new ue(N());new pe(N());new je(N());const P=new fe(N()),y=ye(s=>({user:null,isAuthenticated:!1,isLoading:!0,error:null,login:async(r,t)=>{try{s({isLoading:!0,error:null}),await j.createEmailSession(r,t);const i=await j.get(),n=await j.getPrefs(),a=await P.list();let l="user";a.teams.some(m=>m.$id==="super-admins")?l="super_admin":a.teams.some(m=>m.$id==="admins")&&(l="admin");const d={id:i.$id,email:i.email,name:i.name,role:l,avatar:n.avatar,phone:n.phone,notificationPreferences:n.notificationPreferences||{email:!0,sms:!1,securityAlerts:!0,dailyReports:!1},createdAt:new Date(i.$createdAt),updatedAt:new Date(i.$updatedAt)};s({user:d,isAuthenticated:!0,isLoading:!1})}catch(i){throw console.error("Login error:",i),s({error:i.message||"Errore durante il login",isLoading:!1,isAuthenticated:!1}),i}},logout:async()=>{try{await j.deleteSession("current"),s({user:null,isAuthenticated:!1})}catch(r){console.error("Logout error:",r)}},register:async(r,t,i)=>{try{s({isLoading:!0,error:null}),await j.create(Ne.unique(),r,t,i),await j.createEmailSession(r,t);const n=await j.get();await Te.createDocument("sg-security-db","users",n.$id,{email:r,name:i,role:"user",notificationPreferences:JSON.stringify({email:!0,sms:!1,securityAlerts:!0,dailyReports:!1})}),await y.getState().checkAuth()}catch(n){throw console.error("Registration error:",n),s({error:n.message||"Errore durante la registrazione",isLoading:!1}),n}},checkAuth:async()=>{try{s({isLoading:!0});const r=await j.get(),t=await j.getPrefs(),i=await P.list();let n="user";i.teams.some(l=>l.$id==="super-admins")?n="super_admin":i.teams.some(l=>l.$id==="admins")&&(n="admin");const a={id:r.$id,email:r.email,name:r.name,role:n,avatar:t.avatar,phone:t.phone,notificationPreferences:t.notificationPreferences||{email:!0,sms:!1,securityAlerts:!0,dailyReports:!1},createdAt:new Date(r.$createdAt),updatedAt:new Date(r.$updatedAt)};s({user:a,isAuthenticated:!0,isLoading:!1})}catch{s({user:null,isAuthenticated:!1,isLoading:!1})}},updateUser:r=>{s(t=>({user:t.user?{...t.user,...r}:null}))}}));typeof window<"u"&&y.getState().checkAuth();function Le(){const{isAuthenticated:s,isLoading:r}=y();return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-dark-bg",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):s?e.jsx(V,{}):e.jsx(A,{to:"/login"})}function Pe(){var u;const s=M(),r=O(),{user:t,logout:i}=y(),[n,a]=c.useState(!1),l=[{name:"Dashboard",href:"/",icon:G},{name:"Recordings",href:"/recordings",icon:K},{name:"Analytics",href:"/analytics",icon:W}],d=[{name:"Users",href:"/admin/users",icon:H},{name:"Settings",href:"/admin/settings",icon:Q}],m=async()=>{await i(),r("/login")};return e.jsxs("div",{className:"min-h-screen bg-dark-bg",children:[n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>a(!1)}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-dark-surface border-r border-dark-border transform transition-transform lg:transform-none ${n?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between px-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"text-xl font-bold",children:"SG Security"})]}),e.jsx("button",{onClick:()=>a(!1),className:"lg:hidden",children:e.jsx(F,{className:"h-6 w-6"})})]}),e.jsxs("nav",{className:"flex-1 space-y-1 px-4 py-4",children:[l.map(x=>{const o=x.icon,f=s.pathname===x.href;return e.jsxs(S,{to:x.href,className:`flex items-center space-x-3 px-3 py-2 rounded-md transition-colors ${f?"bg-primary/20 text-primary":"text-gray-400 hover:bg-dark-bg hover:text-white"}`,children:[e.jsx(o,{className:"h-5 w-5"}),e.jsx("span",{children:x.name})]},x.name)}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4",children:e.jsx("p",{className:"px-3 text-xs font-semibold text-gray-500 uppercase",children:"Admin"})}),d.map(x=>{const o=x.icon,f=s.pathname===x.href;return e.jsxs(S,{to:x.href,className:`flex items-center space-x-3 px-3 py-2 rounded-md transition-colors ${f?"bg-primary/20 text-primary":"text-gray-400 hover:bg-dark-bg hover:text-white"}`,children:[e.jsx(o,{className:"h-5 w-5"}),e.jsx("span",{children:x.name})]},x.name)})]})]}),e.jsxs("div",{className:"border-t border-dark-border p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium",children:((u=t==null?void 0:t.name)==null?void 0:u.charAt(0))||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:(t==null?void 0:t.name)||"User"}),e.jsx("p",{className:"text-xs text-gray-400",children:(t==null?void 0:t.email)||"user@example.com"})]})]}),e.jsxs("button",{onClick:m,className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-400 hover:bg-dark-bg hover:text-white rounded-md transition-colors",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:"Logout"})]})]})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsxs("header",{className:"sticky top-0 z-30 flex h-16 items-center justify-between border-b border-dark-border bg-dark-surface/80 backdrop-blur px-6",children:[e.jsx("button",{onClick:()=>a(!0),className:"lg:hidden",children:e.jsx(Y,{className:"h-6 w-6"})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-white",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{className:"absolute top-0 right-0 h-2 w-2 bg-red-500 rounded-full"})]})})]}),e.jsx("main",{className:"p-6",children:e.jsx(V,{})})]})]})}function Ie(){const s=O(),{login:r}=y(),[t,i]=c.useState(""),[n,a]=c.useState(""),[l,d]=c.useState(""),[m,u]=c.useState(!1),x=async o=>{o.preventDefault(),d(""),u(!0);try{await r(t,n),s("/")}catch(f){d(f.message||"Login failed")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-bg px-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(v,{className:"h-12 w-12 text-primary"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"SG Security AI"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Sign in to your account"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:x,children:[l&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500 rounded-md p-4 flex items-center space-x-2",children:[e.jsx(B,{className:"h-5 w-5 text-red-400"}),e.jsx("p",{className:"text-red-400 text-sm",children:l})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email address"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:o=>i(o.target.value),className:"input mt-1",placeholder:"admin@sg-security.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:n,onChange:o=>a(o.target.value),className:"input mt-1",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"btn-primary w-full flex justify-center items-center",children:m?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"Sign in"})}),e.jsx("div",{className:"text-center text-sm text-gray-400",children:"Demo credentials: admin@demo.com / demo123"})]})]})})}const $e="modulepreload",Ve=function(s){return"/"+s},I={},Oe=function(r,t,i){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(t.map(m=>{if(m=Ve(m),m in I)return;I[m]=!0;const u=m.endsWith(".css"),x=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const o=document.createElement("link");if(o.rel=u?"stylesheet":$e,u||(o.as="script"),o.crossOrigin="",o.href=m,d&&o.setAttribute("nonce",d),document.head.appendChild(o),u)return new Promise((f,z)=>{o.addEventListener("load",f),o.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return n.then(l=>{for(const d of l||[])d.status==="rejected"&&a(d.reason);return r().catch(a)})},g={name:"ssa-locaratow-main",address:"ssa-locaratow-main.1j0se98dbn.viam.cloud",credentials:{type:"api-key",payload:"your-viam-api-key",authEntity:"your-viam-api-key-id"},signalingAddress:"https://app.viam.com:443"};let h=null;async function q(){try{if(h)try{return await h.resourceNames(),h}catch{await h.disconnect(),h=null}console.log("ðŸ¤– Connessione al robot Viam..."),h=await ve({host:g.address,credential:{type:g.credentials.type,payload:g.credentials.payload},signalingAddress:g.signalingAddress}),console.log("âœ… Connesso al robot Viam");const s=await h.resourceNames();return console.log("ðŸ“‹ Risorse disponibili:",s),h}catch(s){throw console.error("âŒ Errore connessione robot:",s),new Error(`Impossibile connettersi al robot: ${s}`)}}async function Fe(){if(h)try{await h.disconnect(),h=null,console.log("ðŸ”Œ Disconnesso dal robot Viam")}catch(s){console.error("Errore durante disconnessione:",s)}}async function _e(s){const r=await q();return new we(r,s)}function Be(){const[s,r]=c.useState({isConnected:!1,isConnecting:!1,error:null,robotClient:null,streamClient:null}),t=c.useCallback(async()=>{r(a=>({...a,isConnecting:!0,error:null}));try{const a=await q(),l=new(await Oe(async()=>{const{StreamClient:d}=await import("./viam-sdk-Cf9OlUZL.js");return{StreamClient:d}},[])).StreamClient(a);r({isConnected:!0,isConnecting:!1,error:null,robotClient:a,streamClient:l})}catch(a){console.error("Errore connessione Viam:",a),r({isConnected:!1,isConnecting:!1,error:a.message||"Errore di connessione",robotClient:null,streamClient:null})}},[]),i=c.useCallback(async()=>{await Fe(),r({isConnected:!1,isConnecting:!1,error:null,robotClient:null,streamClient:null})},[]),n=c.useCallback(async a=>{s.isConnected||await t();try{return await _e(a)}catch(l){return console.error(`Errore accesso camera ${a}:`,l),null}},[s.isConnected,t]);return c.useEffect(()=>(t(),()=>{i()}),[t,i]),c.useEffect(()=>{if(s.error&&!s.isConnecting){const a=setTimeout(()=>{console.log("Tentativo di riconnessione..."),t()},5e3);return()=>clearTimeout(a)}},[s.error,s.isConnecting,t]),{...s,connect:t,disconnect:i,getCameraClient:n}}function Ue(){const{isConnected:s,isConnecting:r,error:t}=Be(),[i,n]=c.useState("checking");c.useEffect(()=>{a()},[]);const a=async()=>{try{b.projectId&&b.projectId!=="sg-security-ai-demo"&&n("connected")}catch{n("error")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s?"bg-green-500 animate-pulse":r?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),e.jsxs("span",{className:"text-sm",children:["Viam: ",r?"Connecting...":s?"Connected":"Offline"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${i==="connected"?"bg-green-500 animate-pulse":i==="checking"?"bg-yellow-500 animate-pulse":"bg-red-500"}`}),e.jsxs("span",{className:"text-sm",children:["Appwrite: ",i==="checking"?"Checking...":i==="connected"?"Connected":"Not Configured"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"ðŸ¤– Viam Configuration"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Robot Address:"}),e.jsx("span",{className:"font-mono text-xs",children:"Not configured"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"API Key ID:"}),e.jsxs("span",{className:"font-mono text-xs",children:["your-viam-api-key-id".substring(0,8),"..."]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:s?"text-green-400":"text-red-400",children:s?"Active":t||"Disconnected"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"â˜ï¸ Appwrite Configuration"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Endpoint:"}),e.jsx("span",{className:"font-mono text-xs",children:b.endpoint})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Project ID:"}),e.jsx("span",{className:"font-mono text-xs",children:b.projectId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Database ID:"}),e.jsx("span",{className:"font-mono text-xs",children:b.databaseId})]})]}),i==="error"&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-500/20 border border-yellow-500/50 rounded text-xs",children:"âš ï¸ Please configure Appwrite in .env.local"})]})]}),t&&e.jsx("div",{className:"bg-red-500/20 border border-red-500 rounded-md p-4",children:e.jsxs("p",{className:"text-red-400",children:["Viam Error: ",t]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ðŸ“¹ Camera Stream"}),e.jsx("div",{className:"video-container bg-dark-surface rounded-md",children:e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:s?"Camera stream will appear here":"Connect to Viam to view stream"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ðŸš¨ Recent Events"}),e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-gray-400",children:"No recent security events"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Total Events Today"}),e.jsx("p",{className:"text-2xl font-bold",children:"0"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Active Cameras"}),e.jsx("p",{className:"text-2xl font-bold",children:s?"2":"0"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Security Zones"}),e.jsx("p",{className:"text-2xl font-bold",children:"2"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"System Status"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"OK"})]})]})]})}function qe(){const[s,r]=c.useState(new Date().toISOString().split("T")[0]),[t,i]=c.useState("all"),n=[{id:"1",cameraName:"camera-1",cameraDisplayName:"Camera Esterna",type:"event",startTime:"2024-01-25 14:30:00",duration:"00:05:23",size:"125 MB",eventType:"motion_detected"},{id:"2",cameraName:"camera-2",cameraDisplayName:"Camera Interna",type:"continuous",startTime:"2024-01-25 12:00:00",duration:"01:00:00",size:"1.2 GB",eventType:null}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Recordings"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:t,onChange:a=>i(a.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Cameras"}),e.jsx("option",{value:"camera-1",children:"Camera Esterna"}),e.jsx("option",{value:"camera-2",children:"Camera Interna"})]}),e.jsx("input",{type:"date",value:s,onChange:a=>r(a.target.value),className:"input"})]})]}),e.jsx("div",{className:"grid gap-4",children:n.map(a=>e.jsx("div",{className:"card hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32 h-20 bg-dark-surface rounded flex items-center justify-center",children:e.jsx(E,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.cameraDisplayName}),e.jsxs("p",{className:"text-sm text-gray-400",children:[e.jsx(Z,{className:"inline h-3 w-3 mr-1"}),a.startTime," â€¢ Duration: ",a.duration]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.type==="event"?`Event: ${a.eventType}`:"Continuous Recording","â€¢ Size: ",a.size]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"btn-secondary p-2",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{className:"btn-secondary p-2",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx("button",{className:"btn-secondary p-2 hover:bg-red-500/20 hover:text-red-400",children:e.jsx(U,{className:"h-4 w-4"})})]})]})},a.id))}),n.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No recordings found for the selected date"})})]})}function ze(){const s=[{hour:"00:00",events:2},{hour:"04:00",events:1},{hour:"08:00",events:5},{hour:"12:00",events:3},{hour:"16:00",events:7},{hour:"20:00",events:4}],r=[{name:"Motion Detected",value:45,color:"#0ea5e9"},{name:"Loitering",value:20,color:"#10b981"},{name:"Intrusion",value:15,color:"#f59e0b"},{name:"Gate Activity",value:20,color:"#8b5cf6"}],t=[{camera:"External",events:65},{camera:"Internal",events:35}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Total Events (24h)"}),e.jsx("p",{className:"text-3xl font-bold",children:"127"}),e.jsx("p",{className:"text-xs text-green-400",children:"+12% from yesterday"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Critical Alerts"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:"3"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Requires attention"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Avg Response Time"}),e.jsx("p",{className:"text-3xl font-bold",children:"2.5s"}),e.jsx("p",{className:"text-xs text-green-400",children:"-0.3s improvement"})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"System Uptime"}),e.jsx("p",{className:"text-3xl font-bold",children:"99.9%"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Last 30 days"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Events Timeline (24h)"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(Ce,{data:s,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(T,{dataKey:"hour",stroke:"#9CA3AF"}),e.jsx(L,{stroke:"#9CA3AF"}),e.jsx(C,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelStyle:{color:"#9CA3AF"}}),e.jsx(ke,{type:"monotone",dataKey:"events",stroke:"#0ea5e9",strokeWidth:2})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Events by Type"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(Ae,{children:[e.jsx(Se,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:i,percent:n})=>`${i} ${(n*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((i,n)=>e.jsx(Ee,{fill:i.color},`cell-${n}`))}),e.jsx(C,{})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Camera Activity"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(Re,{data:t,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(T,{dataKey:"camera",stroke:"#9CA3AF"}),e.jsx(L,{stroke:"#9CA3AF"}),e.jsx(C,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151"},labelStyle:{color:"#9CA3AF"}}),e.jsx(De,{dataKey:"events",fill:"#10b981"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Activity Heatmap"}),e.jsx("div",{className:"h-[300px] bg-dark-surface rounded flex items-center justify-center",children:e.jsx("p",{className:"text-gray-400",children:"Heatmap visualization coming soon"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent High-Priority Events"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-2 px-4",children:"Time"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Camera"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Severity"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Status"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-dark-border/50",children:[e.jsx("td",{className:"py-2 px-4",children:"16:45"}),e.jsx("td",{className:"py-2 px-4",children:"Intrusion Detected"}),e.jsx("td",{className:"py-2 px-4",children:"Camera Esterna"}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("span",{className:"text-red-400",children:"Critical"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("span",{className:"text-green-400",children:"Resolved"})})]}),e.jsxs("tr",{className:"border-b border-dark-border/50",children:[e.jsx("td",{className:"py-2 px-4",children:"14:30"}),e.jsx("td",{className:"py-2 px-4",children:"Unauthorized Access"}),e.jsx("td",{className:"py-2 px-4",children:"Camera Interna"}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("span",{className:"text-orange-400",children:"High"})}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("span",{className:"text-yellow-400",children:"Pending"})})]})]})]})})]})]})}function Me(){const[s]=c.useState([{id:"1",name:"Admin User",email:"admin@sg-security.com",role:"super_admin",lastActive:"2024-01-25 15:30",status:"active"},{id:"2",name:"Security Guard",email:"guard@sg-security.com",role:"user",lastActive:"2024-01-25 14:00",status:"active"}]),r=t=>{const i={super_admin:"bg-purple-500/20 text-purple-400 border-purple-500/50",admin:"bg-blue-500/20 text-blue-400 border-blue-500/50",user:"bg-gray-500/20 text-gray-400 border-gray-500/50"};return i[t]||i.user};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Add User"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Last Active"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-b border-dark-border/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.email})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs border ${r(t.role)}`,children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:t.role.replace("_"," ")})]})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-400",children:t.lastActive}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs ${t.status==="active"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:t.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-1 hover:bg-dark-border rounded",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-1 hover:bg-red-500/20 hover:text-red-400 rounded",children:e.jsx(U,{className:"h-4 w-4"})})]})})]},t.id))})]})})})]})}function Ge(){const[s,r]=c.useState("general"),t=[{id:"general",name:"General",icon:v},{id:"cameras",name:"Cameras",icon:ae},{id:"notifications",name:"Notifications",icon:_},{id:"database",name:"Database",icon:re},{id:"network",name:"Network",icon:ne}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Settings"}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Changes"})]})]}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsx("div",{className:"w-64",children:e.jsx("nav",{className:"space-y-1",children:t.map(i=>{const n=i.icon;return e.jsxs("button",{onClick:()=>r(i.id),className:`w-full flex items-center space-x-3 px-4 py-2 rounded-md transition-colors ${s===i.id?"bg-primary/20 text-primary border-l-2 border-primary":"hover:bg-dark-surface text-gray-400"}`,children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{children:i.name})]},i.id)})})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"card",children:[s==="general"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"General Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"System Name"}),e.jsx("input",{type:"text",className:"input",defaultValue:"SG Security AI"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Time Zone"}),e.jsxs("select",{className:"input",children:[e.jsx("option",{children:"UTC"}),e.jsx("option",{children:"Europe/Rome"}),e.jsx("option",{children:"America/New_York"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Video Buffer Duration (minutes)"}),e.jsx("input",{type:"number",className:"input",defaultValue:"1",min:"1",max:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ML Confidence Threshold"}),e.jsx("input",{type:"number",className:"input",defaultValue:"0.7",min:"0.1",max:"1",step:"0.1"})]})]})]}),s==="cameras"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Camera Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border border-dark-border rounded-md",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Camera Esterna"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e.jsx("input",{type:"text",className:"input",defaultValue:"camera-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",className:"input",defaultValue:"Camera Esterna"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Resolution"}),e.jsxs("select",{className:"input",children:[e.jsx("option",{children:"1920x1080"}),e.jsx("option",{children:"1280x720"}),e.jsx("option",{children:"640x480"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Frame Rate"}),e.jsx("input",{type:"number",className:"input",defaultValue:"30"})]})]})]}),e.jsxs("div",{className:"p-4 border border-dark-border rounded-md",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Camera Interna"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e.jsx("input",{type:"text",className:"input",defaultValue:"camera-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",className:"input",defaultValue:"Camera Interna"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Resolution"}),e.jsxs("select",{className:"input",children:[e.jsx("option",{children:"1920x1080"}),e.jsx("option",{children:"1280x720"}),e.jsx("option",{children:"640x480"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Frame Rate"}),e.jsx("input",{type:"number",className:"input",defaultValue:"30"})]})]})]})]})]}),s==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Notification Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Send alerts via email"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Send critical alerts via SMS"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Daily Reports"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Receive daily security summaries"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]})]})]}),s==="database"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Database Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-dark-surface rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Database Status"}),e.jsx("p",{className:"text-green-400",children:"Connected"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Retention Period (days)"}),e.jsx("input",{type:"number",className:"input",defaultValue:"30",min:"7",max:"365"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Auto-backup Frequency"}),e.jsxs("select",{className:"input",children:[e.jsx("option",{children:"Daily"}),e.jsx("option",{children:"Weekly"}),e.jsx("option",{children:"Monthly"})]})]}),e.jsx("button",{className:"btn-secondary",children:"Export Database Backup"})]})]}),s==="network"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Network Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-dark-surface rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Viam Connection"}),e.jsx("p",{className:"text-green-400",children:"Connected to ssa-locaratow-main"})]}),e.jsxs("div",{className:"p-4 bg-dark-surface rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Appwrite Connection"}),e.jsx("p",{className:"text-yellow-400",children:"Configuration Required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"API Timeout (seconds)"}),e.jsx("input",{type:"number",className:"input",defaultValue:"30",min:"5",max:"120"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Retry Attempts"}),e.jsx("input",{type:"number",className:"input",defaultValue:"3",min:"0",max:"10"})]})]})]})]})})]})]})}const $={listeners:new Set,toasts:[],addToast(s){const r={...s,id:Math.random().toString(36).substr(2,9),duration:s.duration||5e3};this.toasts=[...this.toasts,r],this.notify(),r.duration>0&&setTimeout(()=>{this.removeToast(r.id)},r.duration)},removeToast(s){this.toasts=this.toasts.filter(r=>r.id!==s),this.notify()},notify(){this.listeners.forEach(s=>s(this.toasts))},subscribe(s){return this.listeners.add(s),()=>this.listeners.delete(s)}};function Ke({toasts:s}){const[r,t]=c.useState([]);c.useEffect(()=>{if(s){t(s);return}else{const a=$.subscribe(t);return()=>{a()}}},[s]);const i=a=>{switch(a){case"success":return e.jsx(le,{className:"h-5 w-5 text-green-400"});case"error":return e.jsx(B,{className:"h-5 w-5 text-red-400"});case"warning":return e.jsx(ie,{className:"h-5 w-5 text-yellow-400"});case"info":return e.jsx(R,{className:"h-5 w-5 text-blue-400"});default:return e.jsx(R,{className:"h-5 w-5 text-gray-400"})}},n=a=>{switch(a){case"success":return"bg-green-500/20 border-green-500/50";case"error":return"bg-red-500/20 border-red-500/50";case"warning":return"bg-yellow-500/20 border-yellow-500/50";case"info":return"bg-blue-500/20 border-blue-500/50";default:return"bg-dark-surface border-dark-border"}};return e.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2",children:r.map(a=>e.jsxs("div",{className:`flex items-start gap-3 min-w-[300px] max-w-md p-4 rounded-lg border backdrop-blur-sm animate-slide-in ${n(a.type)}`,children:[i(a.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:a.title}),a.description&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]}),e.jsx("button",{onClick:()=>$.removeToast(a.id),className:"text-gray-400 hover:text-white",children:e.jsx(F,{className:"h-4 w-4"})})]},a.id))})}function We(){const{isAuthenticated:s,isLoading:r}=y();return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-dark-bg",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs(ce,{children:[e.jsx(p,{path:"/login",element:s?e.jsx(A,{to:"/"}):e.jsx(Ie,{})}),e.jsx(p,{element:e.jsx(Le,{}),children:e.jsxs(p,{element:e.jsx(Pe,{}),children:[e.jsx(p,{path:"/",element:e.jsx(Ue,{})}),e.jsx(p,{path:"/recordings",element:e.jsx(qe,{})}),e.jsx(p,{path:"/analytics",element:e.jsx(ze,{})}),e.jsx(p,{path:"/admin/users",element:e.jsx(Me,{})}),e.jsx(p,{path:"/admin/settings",element:e.jsx(Ge,{})})]})}),e.jsx(p,{path:"*",element:e.jsx(A,{to:"/"})})]}),e.jsx(Ke,{})]})}const He=new ge({defaultOptions:{queries:{staleTime:5*60*1e3,refetchOnWindowFocus:!1}}});de.createRoot(document.getElementById("root")).render(e.jsx(oe.StrictMode,{children:e.jsx(me,{client:He,children:e.jsx(xe,{children:e.jsx(We,{})})})}));
